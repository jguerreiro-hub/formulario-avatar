<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Inquérito com Avatar</title>

  <!-- Script do avatar da Soul Machines -->
  <script 
    id="sm-widget"
    src="https://static.soulmachines.com/widget-snippet-1.12.0.min.js" 
    data-sm-api-key="eyJzb3VsSWQiOiJkZG5hLWlzY3RlODQ0ZC0tby1tZXUtcHJpbWVpcm8tcHJvaiIsImF1dGhTZXJ2ZXIiOiJodHRwczovL2RoLnNvdWxtYWNoaW5lcy5jbG91ZC9hcGkvand0IiwiYXV0aFRva2VuIjoiYXBpa2V5X3YxXzczNTZlOTYxLTc0YzgtNDNkOC1hYWM1LWU5ZmYzZDA5ZDhkNCJ9"
    data-sm-layout="fullFrame">
  </script>

  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 2rem;
      background-color: #f9f9f9;
      text-align: center;
    }

    iframe {
      width: 100%;
      max-width: 1000px;
      height: 800px;
      border: none;
    }

    #timeout-message {
      display: none;
      margin-top: 2rem;
      padding: 1rem;
      background-color: #ffe0e0;
      color: #900;
      border: 1px solid #d00;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <h2>Por favor responda ao inquérito abaixo</h2>

  <iframe src="https://iscteiul.co1.qualtrics.com/jfe/form/SV_0feM1WMf9sHxTAa"></iframe>

  <div id="timeout-message">
    A sessão com o avatar foi encerrada por inatividade.
  </div>

  <script>
    let inactivityTimer;

    function closeAvatar() {
      // Remove o contêiner do avatar
      const container = document.getElementById('sm-widget-container');
      if (container) {
        container.remove();
        console.log("Avatar removido com sucesso.");
      } else {
        console.log("Avatar não encontrado.");
      }

      // Opcional: remover o script também
      const smScript = document.getElementById('sm-widget');
      if (smScript) smScript.remove();

      // Mostrar mensagem ao utilizador
      document.getElementById('timeout-message').style.display = 'block';
    }

    function startInactivityTimer() {
      clearTimeout(inactivityTimer);
      inactivityTimer = setTimeout(closeAvatar, 10000); // 10 segundos
    }

    // Iniciar ao carregar
    window.onload = startInactivityTimer;

    // Reiniciar temporizador com qualquer atividade
    document.addEventListener('mousemove', startInactivityTimer);
    document.addEventListener('keydown', startInactivityTimer);
  </script>
</body>
</html>
